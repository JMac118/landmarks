<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
	</head>
	<body>
		<div id="landmarks">
			<p>(no landmarks found)</p>
		</div>
		<script>
chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
	chrome.tabs.sendMessage(tabs[0].id, "get-landmarks", receiveLandmarks);
});


function getLandmarkName(landmark) {
	if (landmark.label) {
		return landmark.label + " (" + landmark.role + ")";
	} else {
		return landmark.role;
	}
}


function receiveLandmarks(response) {
	var html_code = '<ul>';
	var previous_depth = 0;

	response.forEach(function (landmark) {
		var depth_change = landmark.depth - previous_depth;

		if (depth_change > 0) {
			html_code += '<ul>';
		}

		if (depth_change < 0) {
			html_code += '</ul>';
		}

		html_code += '<li>';
		html_code += getLandmarkName(landmark);
		html_code += '</li>';

		previous_depth = landmark.depth;
	});

	html_code += '</ul>';
	document.getElementById('landmarks').innerHTML = html_code;
}
		</script>
	</body>
</html>
